<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperature Control</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .interface { margin: 20px; padding: 20px; border: 1px solid #ddd; }
        .temperature { font-size: 24px; margin-top: 20px; }
        .button-container { margin-top: 10px; }
        .temp-button { margin: 0 5px; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>
<body>
    <h1>Temperature Control Interfaces</h1>

    <div class="interface">
        <h2>Infotainment Screen Knob</h2>
        <input type="range" id="infotainmentKnobSlider" class="slider" min="15" max="30" value="20">
        <div class="temperature" id="infotainmentKnobTemp">Temperature: 20°C</div>
    </div>

    <div class="interface">
        <h2>Infotainment Screen Touch</h2>
        <input type="range" id="infotainmentTouchSlider" class="slider" min="15" max="30" value="20">
        <div class="temperature" id="infotainmentTouchTemp">Temperature: 20°C</div>
    </div>

    <div class="interface">
        <h2>Steering Wheel Touch</h2>
        <div class="button-container">
            <button class="temp-button" onclick="updateTemperature('Steering Wheel Touch', -1)">-</button>
            <button class="temp-button" onclick="updateTemperature('Steering Wheel Touch', 1)">+</button>
        </div>
        <div class="temperature" id="steeringWheelTouchTemp">Temperature: 20°C</div>
    </div>

    <div class="interface">
        <h2>Steering Wheel Knob (Hardware)</h2>
        <div class="temperature" id="steeringWheelKnobTemp">Temperature: 20°C</div>
        <p>This is controlled by the physical rotary encoder</p>
        <div id="buttonPressIndicator"></div>
    </div>

    <script>
        var socket = io();
        var currentTemperature = 20;

        function updateAllTemperatures(temp) {
            document.getElementById('infotainmentKnobTemp').textContent = `Temperature: ${temp}°C`;
            document.getElementById('infotainmentTouchTemp').textContent = `Temperature: ${temp}°C`;
            document.getElementById('steeringWheelTouchTemp').textContent = `Temperature: ${temp}°C`;
            document.getElementById('steeringWheelKnobTemp').textContent = `Temperature: ${temp}°C`;
            document.getElementById('infotainmentKnobSlider').value = temp;
            document.getElementById('infotainmentTouchSlider').value = temp;
        }

        function updateTemperature(interface, value) {
            socket.emit('temperature_update', { 
                temperature: value,
                interface: interface
            });
        }

        document.getElementById('infotainmentKnobSlider').oninput = function() {
            updateTemperature('Infotainment Screen Knob', this.value);
        }

        document.getElementById('infotainmentTouchSlider').oninput = function() {
            updateTemperature('Infotainment Screen Touch', this.value);
        }

        socket.on('temperature_sync', function(data) {
            currentTemperature = data.temperature;
            updateAllTemperatures(currentTemperature);
        });

        socket.on('button_press', function(data) {
            console.log(data.message);
            document.getElementById('buttonPressIndicator').textContent = "Button Pressed!";
            setTimeout(function() {
                document.getElementById('buttonPressIndicator').textContent = "";
            }, 2000);
        });

        socket.on('experiment_started', function(data) {
            alert('Experiment started for participant: ' + data.participant);
        });

        socket.on('experiment_ended', function(data) {
            alert('Experiment ended for participant: ' + data.participant);
        });
    </script>
</body>
</html>
